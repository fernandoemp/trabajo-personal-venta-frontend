<div class="container1">
    <div class="row container2 fadeInDown bordes borde-sombra">
        <div class="row">
            <div class="col-12 col-md-4">
                <div class="row justify-content-center text-center">
                    <figure><img src="assets/home/publicar.jpg" class="img-fluid" alt="sing up image"></figure>
                    <label class="usuario col-12 text-left"> <i class="fa fa-user fa-fw"></i> {{loginService.userLogueado}}</label>
                </div>
            </div>

            <div class="col-12 col-md-7">
                <div class="row">
                    <h2 class="form-title col-12">Redactar Noticia</h2>
                    <br>
                    <div class="col-12">

                        <form method="POST" class="noticia-form col-12" #formNoticia="ngForm" name="formNoticia" id="noticia-form">
                            <div class="form-group row">
                                <label for="titulo" class="col-3 col-form-label">Titulo:</label>
                                <div class="col-9">
                                    <input type="text" name="titulo" class="form-control" id="titulo" #titulo="ngModel" [(ngModel)]="noticia.titulo" placeholder="Titulo" required>
                                </div>
                                <div *ngIf="titulo.invalid && (titulo.dirty || titulo.touched)" class=" mt-1 text-danger col-sm-12 offset-md-3 col-md-9">
                                    <div *ngIf="titulo.errors.required">
                                        *Titulo es requerido.
                                    </div>
                                </div>
                            </div>

                            <div class="row form-group">
                                <label for="descrip" class="col-12 col-md-4">Descripci&oacute;n: </label>
                                <div class="col-12 col-md-8 text-right"> Te quedan: {{tamTexto}} caracteres. </div>
                            </div>
                            <div class="row form-group">
                                <textarea class="form-control mr-3 ml-3" id="descrip" placeholder="Ingresa una breve descripciÃ³n." id="descrip" name="descrip" #descrip="ngModel" [(ngModel)]="noticia.descripcion" minlength="10" rows="2" name="txtTexto" [maxlength]="tamMaxTexto" (ngModelChange)="cambiarTamTexto()"
                                    required>
                </textarea>
                                <div *ngIf="descrip.invalid && (descrip.dirty || descrip.touched)" class=" mt-1 text-danger col-sm-12">
                                    <div *ngIf="descrip.errors.required">
                                        La descripci&oacute;n es requerida.
                                    </div>
                                    <div *ngIf="descrip.errors.minlength">
                                        La descripci&oacute;n debe tener al menos 10 caracteres.
                                    </div>
                                </div>
                            </div>


                            <div class="form-group row">
                                <label for="imagen" class="col-3 col-form-label">Imagen:</label>
                                <div class="col-9">

                                    <label for="imagen" class="bttn">
                    <i class="fas fa-cloud-upload-alt"></i> Subir archivo
                  </label>
                                    <input type="file" name="imagen" class="form-control" id="imagen" alife-file-to-base64 multiple (onFileChanged)="onFileChanges($event)" accept="image/x-png,image/gif,image/jpeg" style='display: none;'>
                                </div>
                                <div class="col-5 col-md-3 m-2 card border-dark text-center" *ngFor="let item of arrayImagenes">
                                    <img *ngIf="arrayImagenes.length>0" [src]="item" alt="img" class="img-fluid justify-content-center m-auto" width="90%">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="agree-term" class="label-agree-term"> <span><span></span></span><i
                    class="fa fa-facebook-square"></i>
                  Publicar en facebook. </label>
                                <input class="checkBox" type="checkbox" name="publicar-fb" id="publicar-fb" [(ngModel)]="postearEnFb" />
                            </div>
                            <div class="form-group form-button">
                                <input class="btn-disabled" type="submit" name="publicar" id="publicar" value="Publicar" (click)="verModal(confirmar);" [disabled]="!formNoticia.form.valid" />
                                <button class="bttn2" type="button" (click)="limpiarCampos(); formNoticia.reset()">Cancelar</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

        </div>
        <br>
        <div class="w-100 d-block"></div>
        <!-- BOTON PARA ABRIR ADIMINISTRACION DE NOTICIAS-->
        <div class="row align-items-end">

            <button type="button " class="btnAdministrar btn btn-outline-success" (click)="cambiarValor()">
        <i class="fa fa-plus"></i>
        Administrar</button>

        </div>
    </div>


    <div class="container2 mt-3">

        <div class="row " *ngIf="administrar">


            <div class="col-11 col-md-10 mt-2">
                <div class="input-group mb-2 mr-sm-2">
                    <input type="text" class="form-control" placeholder="buscar por titulo..." name="filterNoticia" [(ngModel)]="filterNoticia">
                    <div class="input-group-prepend">
                        <div class="input-group-text"><i class="fas fa-search"></i></div>
                    </div>
                </div>
            </div>


            <!-- imprimir -->
            <div class=" bg-white pb-1 pt-1">
                <div class="col-12 text-right">
                    <button type="button" title="PRINT" class="btn btn-outline-info m-2" (click)="imprimirJson()"><i class="fas fa-print"></i> Imprimir Info</button>
                </div>
            </div>

            <!-- TABLA ADMINISTRACION DE NOTICIAS-->
            <div class="col-12">
                <div class="table-responsive p-3">
                    <table class="table  tabla-rounded" id="table-local" [mfData]="noticias" #mf="mfDataTable" [mfRowsOnPage]="5">
                        <thead>
                            <tr class="text-center">
                                <th scope="col-auto">
                                    <mfDefaultSorter by="usuario">Usuario</mfDefaultSorter>
                                </th>
                                <th scope="col-auto">
                                    <mfDefaultSorter by="fecha">Fecha</mfDefaultSorter>
                                </th>
                                <th scope="col-auto">
                                    <mfDefaultSorter by="titulo">Titulo</mfDefaultSorter>
                                </th>
                                <th scope="col-auto">
                                    <mfDefaultSorter by="descripcion">Descripci&oacute;n</mfDefaultSorter>
                                </th>
                                <th scope="col-auto">
                                    <mfDefaultSorter by="estado">Estado</mfDefaultSorter>
                                </th>
                                <th style="width: 10%">
                                    <mfDefaultSorter by="imagen">Imagen</mfDefaultSorter>
                                </th>
                                <th scope="col-auto"> Acciones</th>
                            </tr>
                        </thead>
                        <tbody class="text-center" style="font-size:15px">
                            <tr *ngFor="let noticia of mf.data | noticiaFiltro: filterNoticia">
                                <td class=""> {{noticia.usuario.usuario}} </td>
                                <td class=""> {{noticia.fecha | date:"dd-MM-yyyy"}} </td>
                                <td class=""> {{noticia.titulo}} </td>
                                <td class=""> {{noticia.descripcion}} </td>
                                <td class=""> {{noticia.vigente ? 'VIGENTE' : 'NO VIGENTE'}} </td>
                                <td class=""><img class="card-img-top m-auto" [src]="noticia.imagen" alt="...">
                                </td>
                                <td class="">
                                    <button class="btn  m-1" style="font-size:22px" (click)="verModal2(modificar,noticia)"><i class="fa fa-edit text-success"></i>
          </button>
                                    <button class="btn  m-1" style="font-size:22px" (click)="verModal2(borrar,noticia)"><i class="fa fa-trash text-danger"></i>
          </button>
                                </td>
                            </tr>
                        </tbody>
                        <tfoot>
                            <tr>
                                <td colspan="8">
                                    <mfBootstrapPaginator [rowsOnPageSet]="[5,10,25]"></mfBootstrapPaginator>
                                </td>
                            </tr>
                        </tfoot>
                    </table>
                </div>

                <!-- MODALS -->
                <div class="col-10">
                    <ng-template #modificar let-modal class="modal fade">
                        <div class="modal-content">
                            <div class="modal-header text-center">
                                <h4 class="modal-title w-100 font-weight-bold">Modificar</h4>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="limpiarCampos(); modal.close()">
          <span aria-hidden="true">&times;</span>
        </button>
                            </div>
                            <div class="modal-body mx-3">
                                <div class="md-form mb-5">
                                    <label data-error="wrong" data-success="right" for="orangeForm-name"><i class="fa fa-calendar"></i>
            Fecha </label>
                                    <input type="datetime-local" id="orangeForm-name" class="form-control validate">{{noticia.fecha| date:"dd-MM-yyyy"}}
                                </div>
                                <div class="md-form mb-5">
                                    <label data-error="wrong" data-success="right" for="orangeForm-name"><i class="fa fa-pencil"></i>
            Titulo
          </label>
                                    <input type="text" id="orangeForm-name" class="form-control validate">{{noticia.titulo}}
                                </div>
                                <div class="md-form mb-5">
                                    <label data-error="wrong" data-success="right" for="orangeForm-name"><i class="fa fa-pencil"></i>
            Descripcion: Te quedan: {{tamTexto}} caracteres. </label>
                                    <textarea class="form-control mr-3 ml-3" id="orangeForm-name" placeholder="Ingresa una breve descripciÃ³n." id="descrip" name="descrip" #descrip="ngModel" [(ngModel)]="noticia.descripcion" minlength="10" rows="2" name="txtTexto" [maxlength]="tamMaxTexto"
                                        (ngModelChange)="cambiarTamTexto()" required>{{noticia.descripcion}}
        </textarea>
                                    <div *ngIf="descrip.invalid && (descrip.dirty || descrip.touched)" class=" mt-1 text-danger col-sm-12">
                                        <div *ngIf="descrip.errors.required">
                                            La descripci&oacute;n es requerida.
                                        </div>
                                        <div *ngIf="descrip.errors.minlength">
                                            La descripci&oacute;n debe tener al menos 10 caracteres.
                                        </div>
                                    </div>

                                </div>
                                <div class="md-form mb-5">
                                    <label data-error="wrong" data-success="right" for="orangeForm-name"><i class="fa fa-search"></i>
            Vigente?</label>
                                    <div class="form-check mr-3 ml-1">
                                        <input class="form-check-input" type="radio" name="vigente" id="vigenteSi" [value]="opcionSi" [(ngModel)]="noticia.vigente">
                                        <label class="form-check-label" for="vigenteSi">
              Si
            </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="vigente" id="vigenteNo" [value]="opcionNo" [(ngModel)]="noticia.vigente" checked>
                                        <label class="form-check-label" for="vigenteNo">
              No
            </label>
                                    </div>


                                </div>







                                <div class="md-form mb-4">
                                    <label data-error="wrong" data-success="right" for="orangeForm-pass"><i class="fa fa-image"></i>
            Imagen </label>
                                    <div class="col-5 col-md-3 m-2 card border-dark text-center" *ngFor="let item of arrayImagenes2">
                                        <img [src]="item" alt="img" class="img-fluid justify-content-center m-auto" width="90%">
                                    </div>


                                    <label for="imagen2" class="bttn">
            <i class="fas fa-cloud-upload-alt"></i> Subir archivo
          </label>
                                    <input type="file" name="imagen2" class="form-control" id="imagen2" alife-file-to-base64 multiple (onFileChanged)="onFileChanges2($event)" accept="image/x-png,image/gif,image/jpeg" required style='display: none;'>

                                </div>
                            </div>
                            <div class="modal-footer d-flex justify-content-center">
                                <button class="bttn" (click)="editar(); modal.close()">Aceptar</button>
                                <button class="bttn2" (click)="limpiarCampos(); modal.close()">Cancelar</button>
                            </div>

                        </div>
                    </ng-template>
                </div>


                <!-- MODAL BORRAR-->
                <div class="col-10">
                    <ng-template #borrar let-modal class="modal fade">
                        <div class="modal-content">
                            <div class="modal-header text-center">
                                <h4 class="modal-title w-100 font-weight-bold">Eliminar</h4>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="limpiarCampos(); modal.close()">
          <span aria-hidden="true">&times;</span>
        </button>
                            </div>
                            <div class="modal-body mx-3">
                                Seguro que desea eliminarla?
                            </div>
                            <div class="modal-footer d-flex justify-content-center">
                                <button class="bttn" (click)="eliminar(); modal.close()">Aceptar</button>
                                <button class="bttn2" (click)="limpiarCampos(); modal.close()">Cancelar</button>
                            </div>
                        </div>
                    </ng-template>
                </div>


            </div>
            <!---->
        </div>

    </div>

    <script type="text/javascript" src="https://connect.facebook.net/en_US/sdk.js"></script>

    <!-- MODAL CONFIRMAR PUBLICACION DE NOTICIA -->
    <div class="col-4">

        <ng-template #confirmar let-c="close" let-d="dismiss">
            <div class="modal-header">
                <h4 class="modal-title" id="modal-basic-title">Publicar</h4>
                <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
          <span aria-hidden="true">&times;</span>
        </button>
            </div>

            <div class="modal-body">
                Â¿Esta seguro/a?
            </div>

            <div class="modal-footer">
                <button class="bttn" (click)="publicar(); formNoticia.reset()" (click)="d('Cross click')">Aceptar</button>
                <button class="bttn2" (click)="limpiarCampos(); d('Cross click') ;  formNoticia.reset()">Cancelar</button>
            </div>
        </ng-template>
    </div>